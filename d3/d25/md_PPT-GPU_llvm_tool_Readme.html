<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>NMSU | Pearl Lab | PPT-GPU: CUDA Flux: A Lightweight Instruction Profiler for CUDA Applications</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">NMSU | Pearl Lab | PPT-GPU
   &#160;<span id="projectnumber">1.2</span>
   </div>
   <div id="projectbrief">PPT-GPU is a scalable and flexible framework to predict the performance of GPUs running general purpose workloads. PPT-GPU can use the virtual (PTX) or the native (SASS) ISAs without sacrificing accuracy, ease of use, or portability. The tool is currently focused on NVIDIA GPUs. We plan to extend our approach to model other vendors&#39; GPUs such as AMD and Intel.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">CUDA Flux: A Lightweight Instruction Profiler for CUDA Applications </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>CUDA Flux is a profiler for GPU applications which reports the basic block executions frequencies of compute kernels</p>
<h1><a class="anchor" id="autotoc_md1"></a>
Dependencies</h1>
<ul>
<li>LLVM: <br  />
 CUDA Flux is tested and developed with llvm 11.0</li>
</ul>
<div class="fragment"><div class="line">git clone --branch release/11.x https://github.com/llvm/llvm-project.git</div>
</div><!-- fragment --><p>CMake config: </p><div class="fragment"><div class="line">cmake -DLLVM_ENABLE_PROJECTS=clang -DCMAKE_INSTALL_PREFIX=/opt/llvm-11.0 \</div>
<div class="line">-DCMAKE_BUILD_TYPE=Release -DLLVM_ENABLE_ASSERTIONS=ON \</div>
<div class="line">-DLLVM_ENABLE_DOXYGEN=OFF -DLLVM_BUILD_DOCS=OFF -GNinja \</div>
<div class="line">-DLLVM_INSTALL_BINUTILS_SYMLINKS=ON -DBUILD_SHARED_LIBS=ON \</div>
<div class="line">../llvm</div>
</div><!-- fragment --><ul>
<li>re2c lexer generator - <a href="http://re2c.org/">http://re2c.org/</a> (make sure to check your package manager first)</li>
<li>CUDA SDK &gt;= 9.0 <br  />
</li>
<li>Python (python3 preferred) with the yaml package installed</li>
<li>environment-modules (optional, but recommended)</li>
</ul>
<h1><a class="anchor" id="autotoc_md2"></a>
Recommended Dependencies As tested on:</h1>
<ul>
<li>CMake 3.20</li>
<li>GCC 7.3</li>
<li>Cuda 10.2</li>
<li>LLVM 11.1</li>
</ul>
<h2><a class="anchor" id="autotoc_md3"></a>
Install</h2>
<div class="fragment"><div class="line"># Make sure LLVM and CUDA are in your paths</div>
<div class="line">git clone https://github.com/UniHD-CEG/cuda-flux.git</div>
<div class="line">cd cuda-flux &amp;&amp; mkdir build &amp;&amp; cd build</div>
<div class="line">cmake -DCMAKE_INSTALL_PREFIX=/opt/cuda-flux .. # change install dir if you wish</div>
<div class="line">make install</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md4"></a>
Usage</h2>
<p>Make sure the bin folder of your cuda-flux installation is in your path. Better: use environment-module to load cuda-flux. </p><div class="fragment"><div class="line">module load /opt/cuda-flux/module/cuda_flux # LLVM and CUDA need to be loaded first!</div>
</div><!-- fragment --><p>Compile your CUDA application:</p>
<p>``<code> clang_cf++ --cuda-gpu-arch=sm_35 -std=c++11 -lcudart test/saxpy.cu -o saxpy</code> ```</p>
<p>Execute the binary like usual: <code>./saxpy</code></p>
<p>Output: <br  />
 If any kernel was executed there is a bbc.txt file. Each kernel execution results in a line with the following information:</p><ul>
<li>kernel name</li>
<li>gridDim{X,Y,Z}</li>
<li>blockDim{X,Y,Z}</li>
<li>shared Memory size</li>
<li>Profiling Mode (full, CTA, warp)</li>
<li>List of executions counters for each block <br  />
</li>
</ul>
<p>The PTX instructions for all kernels are stored in the <code>PTX_Analysis.yml</code> file. The order of the Basic Blocks corresponds with the order of the counters in the bbc.txt file.</p>
<p>Profiling mode is controlled by the environment variable <code>MEKONG_PROFILINGMODE</code>. If is is not set or set to 0 all threads are profiled, which is the recommended setting. <code>export MEKONG_PROFILINGMODE=1</code> will only profile one CTA and <code>export MEKONG_PROFILINGMODE=2</code> will profile only one warp. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri Mar 11 2022 13:31:25 for NMSU | Pearl Lab | PPT-GPU by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
